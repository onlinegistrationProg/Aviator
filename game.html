<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aviator Game</title>
<style>
    body {
        margin: 0;
        background: #0d0d0f;
        font-family: Arial, sans-serif;
        color: white;
        text-align: center;
    }
    header {
        padding: 10px;
        background: #111;
        color: #ff0033;
        font-size: 24px;
        font-weight: bold;
    }
    #balanceBox {
        margin-top: 15px;
        font-size: 20px;
        background: #222;
        padding: 10px;
        display: inline-block;
        border-radius: 10px;
    }
    #crashDisplay {
        margin-top: 30px;
        font-size: 60px;
        font-weight: bold;
        color: #44ff44;
    }
    #busted {
        color: red;
        font-size: 38px;
        margin-top: 10px;
        display: none;
    }
    .controls {
        margin-top: 40px;
    }
    input {
        width: 200px;
        padding: 10px;
        margin: 10px;
        font-size: 18px;
        border-radius: 10px;
        border: none;
        text-align: center;
    }
    button {
        width: 220px;
        padding: 12px;
        margin: 10px;
        background: #ff0033;
        border: none;
        color: white;
        font-size: 20px;
        font-weight: bold;
        border-radius: 10px;
        cursor: pointer;
    }
    button:disabled {
        background: grey;
    }
</style>
</head>
<body>

<header>Avi</header>

<div id="balanceBox">Balance: <span id="balance">0</span> KES</div>

<div id="crashDisplay">1.00×</div>
<div id="busted">BUSTED!</div>

<div class="controls">
    <input type="number" id="stake" placeholder="Enter Amount to Stake">
    <button id="playBtn">PLAY</button>
    <button id="cashoutBtn" disabled>CASHOUT</button>
</div>

<script>
// --- Load balance ---
let balance = Number(localStorage.getItem("aviator_balance")) || 0;
document.getElementById("balance").textContent = balance;

// Elements
const crashDisplay = document.getElementById("crashDisplay");
const bustedTxt = document.getElementById("busted");
const playBtn = document.getElementById("playBtn");
const cashoutBtn = document.getElementById("cashoutBtn");
const stakeInput = document.getElementById("stake");

let currentMultiplier = 1.00;
let crashPoint = 0;
let gameRunning = false;
let interval;

// Random crash generator (1.00x – 50.00x)
function generateCrashPoint() {
    let max = Math.random() < 0.60 ? 5 : Math.random() < 0.90 ? 15 : 50;
    return (Math.random() * max + 1).toFixed(2);
}

// Start the game
playBtn.onclick = function () {
    let stake = Number(stakeInput.value);

    if (stake <= 0) {
        alert("Enter valid stake amount.");
        return;
    }

    if (stake > balance) {
        alert("Insufficient balance.");
        return;
    }

    // Deduct stake
    balance -= stake;
    localStorage.setItem("aviator_balance", balance);
    document.getElementById("balance").textContent = balance;

    // Setup game
    currentMultiplier = 1.00;
    crashDisplay.textContent = "1.00×";
    bustedTxt.style.display = "none";

    gameRunning = true;
    playBtn.disabled = true;
    cashoutBtn.disabled = false;

    crashPoint = generateCrashPoint();

    interval = setInterval(() => {
        currentMultiplier = (currentMultiplier + 0.01).toFixed(2);
        crashDisplay.textContent = currentMultiplier + "×";

        if (currentMultiplier >= crashPoint) {
            // BUST
            clearInterval(interval);
            bustedTxt.style.display = "block";
            crashDisplay.textContent = crashPoint + "×";
            gameRunning = false;
            cashoutBtn.disabled = true;
            playBtn.disabled = false;
        }
    }, 80);
};

// CASHOUT
cashoutBtn.onclick = function () {
    if (!gameRunning) return;

    gameRunning = false;
    clearInterval(interval);

    let stake = Number(stakeInput.value);
    let winAmount = Math.floor(stake * currentMultiplier);

    balance += winAmount;
    localStorage.setItem("aviator_balance", balance);
    document.getElementById("balance").textContent = balance;

    cashoutBtn.disabled = true;
    playBtn.disabled = false;

    alert("You cashed out: " + winAmount + " KES");
};

</script>

</body>
</html>
